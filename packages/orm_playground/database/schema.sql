CREATE TABLE IF NOT EXISTS "orm_migrations"(
  "id" VARCHAR(255) NOT NULL,
  "checksum" VARCHAR(64) NOT NULL,
  "applied_at" TEXT NOT NULL,
  "batch" INTEGER NOT NULL,
  PRIMARY KEY("id")
);
CREATE TABLE IF NOT EXISTS "users"(
  "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
  "email" VARCHAR(255) NOT NULL UNIQUE,
  "name" VARCHAR(255) NOT NULL,
  "active" INTEGER NOT NULL DEFAULT 1,
  "created_at" TEXT,
  "updated_at" TEXT
);
CREATE UNIQUE INDEX "users_email_unique" ON "users"("email");
CREATE TABLE IF NOT EXISTS "posts"(
  "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
  "user_id" INTEGER NOT NULL,
  "title" VARCHAR(255) NOT NULL,
  "body" TEXT,
  "published_at" TEXT,
  "published" INTEGER NOT NULL DEFAULT 0,
  "created_at" TEXT NOT NULL DEFAULT CURRENT_TIMESTAMP,
  "updated_at" TEXT NOT NULL DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY("user_id") REFERENCES "users"("id") ON DELETE CASCADE
);
CREATE INDEX "posts_user_id_index" ON "posts"("user_id");
CREATE TABLE IF NOT EXISTS "comments"(
  "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
  "post_id" INTEGER NOT NULL,
  "user_id" INTEGER,
  "body" TEXT NOT NULL,
  "created_at" TEXT NOT NULL DEFAULT CURRENT_TIMESTAMP,
  "updated_at" TEXT NOT NULL DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY("post_id") REFERENCES "posts"("id") ON DELETE CASCADE,
  FOREIGN KEY("user_id") REFERENCES "users"("id") ON DELETE SET NULL
);
CREATE INDEX "comments_post_id_index" ON "comments"("post_id");
CREATE TABLE IF NOT EXISTS "post_tags"(
  "post_id" INTEGER NOT NULL,
  "tag_id" INTEGER NOT NULL,
  PRIMARY KEY("post_id", "tag_id"),
  FOREIGN KEY("post_id") REFERENCES "posts"("id") ON DELETE CASCADE,
  FOREIGN KEY("tag_id") REFERENCES "tags"("id") ON DELETE CASCADE
);
CREATE TABLE IF NOT EXISTS "tags"(
  "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
  "name" VARCHAR(255) NOT NULL UNIQUE,
  "created_at" TEXT NOT NULL DEFAULT CURRENT_TIMESTAMP,
  "updated_at" TEXT NOT NULL DEFAULT CURRENT_TIMESTAMP
);
CREATE UNIQUE INDEX "tags_name_unique" ON "tags"("name");
INSERT INTO orm_migrations VALUES('2025_11_15_014501_create_users_table','9598082073d5acbdfebf3933dbb9b21771e51a36','2025-11-28T06:31:47.101302Z',1);
INSERT INTO orm_migrations VALUES('2025_11_15_015021_create_posts_table','aff2208227d696520bb42157dd1c924e41c009df','2025-11-28T06:31:47.527435Z',1);
INSERT INTO orm_migrations VALUES('2025_11_15_015036_create_comments_table','ebea25e707dffe5f913c6e0a65f473e89ac2f860','2025-11-28T06:31:47.930517Z',1);
INSERT INTO orm_migrations VALUES('2025_11_15_015055_create_post_tags_table','230f283fd26558bcbbd6804ec86706cb3a463453','2025-11-28T06:31:48.324231Z',1);
INSERT INTO orm_migrations VALUES('2025_11_15_015222_create_tags_table','1d2bb4960a99de5c46bf3532b42a24bc605bdfa1','2025-11-28T06:31:48.729273Z',1);
