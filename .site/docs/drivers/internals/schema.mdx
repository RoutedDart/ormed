---
sidebar_position: 3
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Schema

Schema features are separated from query execution:

- **Query execution** lives on `DriverAdapter`
- **Schema operations / introspection** live on `SchemaDriver`
- **Schema dump/load** is optional via `SchemaStateProvider`

## SchemaDriver

Drivers that support migrations and schema operations implement `SchemaDriver`. It supports:

- applying schema plans (`applySchemaPlan`)
- previewing schema plans (`describeSchemaPlan`)
- introspecting live metadata (tables, columns, indexes, foreign keys)

Ormed’s migration runner builds schema plans from migrations (a list of mutations), and then asks the active driver to apply them.

## SchemaInspector

`SchemaInspector` is a small helper around `SchemaDriver` for common checks:

```dart file=../../../examples/lib/drivers/internals.dart#driver-internals-schema-inspector
```

## Schema plan previews

For schema work, the plan type is `SchemaPlan` (a list of `SchemaMutation` entries). Drivers can preview a plan without running it:

```dart file=../../../examples/lib/drivers/internals.dart#driver-internals-schema-plan-preview
```

Use previews when you want to:
- show “what would run” without applying changes
- log/inspect generated DDL in tests
- build migration tooling that explains a plan

## Schema dumps (SchemaStateProvider)

Some features (like schema dumps used for migration squashing) rely on an optional interface:

- `SchemaStateProvider.createSchemaState(...)` returns a `SchemaState?`
- `SchemaState` can `dump(...)` and `load(...)` when supported

```dart file=../../../examples/lib/drivers/internals.dart#driver-internals-schema-state
```
