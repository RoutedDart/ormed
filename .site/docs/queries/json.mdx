---
sidebar_position: 6
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# JSON

Ormed has first-class JSON support across models and query builder APIs.

## Prerequisites

- [Query Builder](./query-builder)
- [Casting](../models/casting)

## What You’ll Learn

- How to query JSON fields with helper and selector syntax
- How JSON indexing and path semantics behave
- How to update JSON payloads through query and model workflows

## Step Outcome

By the end of this page, you should be able to map JSON columns, filter by JSON paths, and apply partial JSON updates without replacing full documents.

Ormed supports:
- JSON fields on models via casts/codecs
- JSON path filters via `whereJson*` helpers
- JSON selector syntax with `->` / `->>`
- JSON path/patch updates from query and tracked-model APIs

:::note
These examples focus on JSON operations only. They assume you already have a working `DataSource`.
:::

## 1. Define JSON Model Fields

```dart file=../../examples/lib/queries/json.dart#json-model-field
```

## 2. Query JSON Data

In Dart strings, `$` is interpolation — if you write selectors with `$.path`, use raw strings (`r'...'`), or omit the `$` prefix (`metadata->>mode`).

Array indexes can be addressed as either:
- `items[0]` (explicit), or
- `items.0` (shorthand; normalized to `items[0]`)

If you need a numeric **object key**, use bracket quoting: `items["0"]`.

<Tabs groupId="json-query" defaultValue="helpers">
  <TabItem value="helpers" label="Helpers" default>
```dart file=../../examples/lib/queries/json.dart#json-where-json-helpers
```
  </TabItem>
  <TabItem value="selectors" label="Selector syntax">
```dart file=../../examples/lib/queries/json.dart#json-where-selector-syntax
```
  </TabItem>
  <TabItem value="indexing" label="Indexing">
```dart file=../../examples/lib/queries/json.dart#json-where-indexing
```
  </TabItem>
</Tabs>

## 3. Update JSON Values

<Tabs groupId="json-update" defaultValue="query">
  <TabItem value="query" label="Query update" default>
```dart file=../../examples/lib/queries/json.dart#json-update-query
```
  </TabItem>
  <TabItem value="model" label="Tracked model">
```dart file=../../examples/lib/queries/json.dart#json-update-model
```
  </TabItem>
</Tabs>

## Practical Rules

- Use helper methods (`whereJsonContains`, `whereJsonLength`, `whereJsonContainsKey`) for portability and readability.
- Use raw selector syntax for advanced expressions or mixed SQL/JSON predicates.
- Prefer path/patch updates over full document replacement to reduce write size.

## Verify Your Setup

- JSON model fields round-trip through your driver.
- JSON selector filters return expected rows for both object keys and array indexes.
- Partial JSON updates preserve unrelated keys.

## Read This Next

- [Query Builder](./query-builder)
- [Casting](../models/casting)
- [PostgreSQL Driver](../drivers/postgres)
