---
sidebar_position: 1
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Query Builder

The Query Builder provides a fluent, type-safe API for building database queries.

:::note Snippet context
- Snippets focus on the query builder calls and omit full setup.
- Unless shown otherwise, assume either:
  - a `DataSource` named `dataSource`, or
  - a default connection configured so static helpers like `Users.query()` work.

Default connection resolution is handled through `ConnectionManager`.
:::

## Getting Started

<Tabs groupId="query-getting-started" defaultValue="default">
  <TabItem value="default" label="Default connection">

```dart file=../../examples/lib/queries.dart#query-getting-started-static
```

  </TabItem>
  <TabItem value="datasource" label="From DataSource">

```dart file=../../examples/lib/queries.dart#query-getting-started
```

  </TabItem>
</Tabs>

## Table Prefixing

If `DataSourceOptions.tablePrefix` is set, Ormed automatically prefixes all **unqualified** table references (base tables, joins, relation/pivot tables, and ad‑hoc `table()` calls). Schema‑qualified names like `public.users` are left untouched.

## Selecting Data

### Get All Records

```dart file=../../examples/lib/queries.dart#query-get-all

```

### Select Specific Columns

```dart file=../../examples/lib/queries.dart#query-select

```

### First Record

```dart file=../../examples/lib/queries.dart#query-first

```

### Find by Primary Key

```dart file=../../examples/lib/queries.dart#query-find

```

## Where Clauses

<Tabs groupId="query-where-clauses" defaultValue="common">
<TabItem value="common" label="Common patterns">

- Prefer `whereEquals('id', id)` for primary key lookups.
- Use `whereIn` for sets, and `whereBetween` for ranges.
- Group complex logic with `where((q) => ...)` so operator precedence is explicit.

</TabItem>
<TabItem value="examples" label="Examples">

```dart file=../../examples/lib/queries.dart#where-clauses

```

</TabItem>
</Tabs>

### Comparison Operators

```dart file=../../examples/lib/queries.dart#where-comparison

```

:::tip Qualified Columns
You can use qualified column names (e.g., `table.column`) in where clauses. This is particularly useful when working with joins or many-to-many relationships where column names might collide.
:::

### In / Not In

```dart file=../../examples/lib/queries.dart#where-in

```

### Null Checks

```dart file=../../examples/lib/queries.dart#where-null

```

### Between

```dart file=../../examples/lib/queries.dart#where-between

```

### Like / Contains

```dart file=../../examples/lib/queries.dart#where-like

```

### Or Where

```dart file=../../examples/lib/queries.dart#where-or

```

### Grouped Conditions

```dart file=../../examples/lib/queries.dart#where-grouped

```

## Ordering

```dart file=../../examples/lib/queries.dart#ordering-limiting

```

## Group Limits

Limit results per group using window functions. This requires a driver/database
that supports window functions.

```dart file=../../examples/lib/queries.dart#group-limits

```

## Aggregates

```dart file=../../examples/lib/queries.dart#aggregates

```

## Distinct

```dart file=../../examples/lib/queries.dart#distinct

```

## Eager Loading Relations

```dart file=../../examples/lib/queries.dart#relations

```

## Raw Expressions

When you need database-specific functionality:

```dart file=../../examples/lib/queries.dart#raw-expressions

```

## Partial Projections

Get partial entities with only selected columns:

```dart file=../../examples/lib/queries.dart#partial-projections

```

## Soft Delete Scopes

For models with soft deletes:

```dart file=../../examples/lib/queries.dart#soft-delete-scopes

```

## Query Caching

Cache query results for improved performance:

```dart file=../../examples/lib/queries.dart#query-caching

```
