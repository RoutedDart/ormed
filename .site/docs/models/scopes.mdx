---
sidebar_position: 5
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Model Scopes

Scopes package reusable query constraints on a model. Ormed supports:

## Prerequisites

- [Defining Models](./defining-models)
- [Query Builder](../queries/query-builder)

## What Youâ€™ll Learn

- How to define global and local scopes
- How generated and inline scopes differ
- How scope registration affects query behavior across the app

## Step Outcome

By the end of this page, you should be able to:

- Register generated scopes correctly during bootstrap
- Apply local scopes for reusable query constraints
- Disable global scopes intentionally in exceptional flows

Ormed supports:
- **Generated scopes** (declared on the model with `@OrmScope`)
- **Inline scopes** (registered at runtime on a `ScopeRegistry`)

:::note Snippet context
- The examples focus on the *scope-related lines* and omit full bootstrapping.
- Where setup is required, the snippet calls `bootstrapOrm()` to wire generated registrations.
:::

<Tabs groupId="model-scopes" defaultValue="generated">
  <TabItem value="generated" label="Generated">

Define scopes as **static** methods that accept a `Query<$Model>` as the first parameter.

Global scopes apply to every query for the model:

```dart file=../../examples/lib/models/model_scopes.dart#model-scopes-global
```

Local scopes are opt-in and can accept positional or named arguments:

```dart file=../../examples/lib/models/model_scopes.dart#model-scopes-local-positional
```

```dart file=../../examples/lib/models/model_scopes.dart#model-scopes-local-named
```

Register generated scopes once during bootstrap:

```dart file=../../examples/lib/models/model_scopes.dart#model-scopes-register
```

Use generated query helpers:

```dart file=../../examples/lib/models/model_scopes.dart#model-scopes-query-local
```

Global scopes apply automatically:

```dart file=../../examples/lib/models/model_scopes.dart#model-scopes-query-global
```

Disable a specific global scope when needed:

```dart file=../../examples/lib/models/model_scopes.dart#model-scopes-query-without-global
```

  </TabItem>
  <TabItem value="inline" label="Inline">

Inline scopes are useful for environment-specific behavior and tests. Register them on a `ScopeRegistry` (usually via `context.scopeRegistry`).

Register scopes:

```dart file=../../examples/lib/models/model_scopes.dart#model-scopes-inline-register
```

Apply them via `scope('name', args)` (and disable globals the same way as generated scopes):

```dart file=../../examples/lib/models/model_scopes.dart#model-scopes-inline-usage
```

  </TabItem>
</Tabs>

## Rules & notes

- **Static only**: scopes must be `static` so both the user model type and generated `$Model` query APIs can reference them consistently.
- **Global scopes must be argument-free** (beyond the initial `Query<T>`).
- Identifiers default to the method name; override with `@OrmScope(identifier: 'custom')` when needed.

## Practical Guidance

- Use global scopes only for always-on constraints (for example soft-delete filters).
- Use local scopes for business filters reused across endpoints.
- Prefer explicit scope names that describe intent (`active`, `recent`, `forTenant`).

## Verify Scope Behavior

1. Test that global scopes apply automatically.
2. Test `withoutGlobalScope(...)` for override paths.
3. Test local scope arguments (positional + named) in queries.

## Read This Next

- [Query Builder](../queries/query-builder)
- [Repository](../queries/repository)
- [Model Events](./events)
