---
title: JSON API
sidebar_position: 5
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# JSON API

In addition to server-rendered HTML pages, our application provides a RESTful JSON API. This is useful for building mobile apps or single-page applications (SPAs) that need to interact with the same data.

## Prerequisites

- [Server & Web Routes](./server-routes)
- [Models & Codegen](./models)

## What You’ll Learn

- How to expose CRUD endpoints with Ormed-backed handlers
- How DTOs shape API write payloads
- How to share model logic between web and API surfaces

## Step Outcome

By the end of this page, you should have:

- Stable JSON contracts for movie and genre resources
- Clear status-code behavior for success, validation failure, and missing resources
- DTO-backed write handlers with minimal parsing/validation boilerplate

## Movie endpoints

The API endpoints use the same database logic as the web handlers but return JSON responses instead of HTML.

<Tabs groupId="api-movies">
  <TabItem value="list" label="List">
    Fetches a list of movies. We use `jsonEncode` to convert the model list to a JSON string.
    ```dart file=../../../../packages/ormed/example/fullstack/lib/src/server/app.dart#api-list-movies
    ```
  </TabItem>
  <TabItem value="show" label="Show">
    Fetches a single movie by ID.
    ```dart file=../../../../packages/ormed/example/fullstack/lib/src/server/app.dart#api-show-movie
    ```
  </TabItem>
  <TabItem value="create" label="Create">
    Creates a new movie from a JSON payload. We parse the request body and use `MovieInsertDto`.
    ```dart file=../../../../packages/ormed/example/fullstack/lib/src/server/app.dart#api-create-movie
    ```
  </TabItem>
  <TabItem value="update" label="Update">
    Updates an existing movie using a JSON payload and `MovieUpdateDto`.
    ```dart file=../../../../packages/ormed/example/fullstack/lib/src/server/app.dart#api-update-movie
    ```
  </TabItem>
  <TabItem value="delete" label="Delete">
    Deletes a movie by ID.
    ```dart file=../../../../packages/ormed/example/fullstack/lib/src/server/app.dart#api-delete-movie
    ```
  </TabItem>
</Tabs>

### Movie API contract (summary)

| Endpoint | Success | Common failures |
| --- | --- | --- |
| `GET /api/movies` | `200` | — |
| `GET /api/movies/:id` | `200` | `404` when not found |
| `POST /api/movies` | `201` | `400` validation / malformed JSON |
| `PATCH /api/movies/:id` | `200` | `400` invalid payload, `404` missing |
| `DELETE /api/movies/:id` | `200` | `404` missing |

## Genre endpoints

<Tabs groupId="api-genres">
  <TabItem value="list" label="List">

```dart file=../../../../packages/ormed/example/fullstack/lib/src/server/app.dart#api-list-genres

```

  </TabItem>
  <TabItem value="show" label="Show">

```dart file=../../../../packages/ormed/example/fullstack/lib/src/server/app.dart#api-show-genre

```

  </TabItem>
</Tabs>

## Error Shape

Handlers in this tutorial return explicit JSON for failure modes. Typical responses are:

- `{"error": "Movie not found"}` for missing records
- `{"errors": [...]}` for validation failures

### Payload Format
All API payloads use the field names defined in your models. For example, when creating a movie, the JSON should look like this:

```json
{
  "title": "Inception",
  "releaseYear": 2010,
  "summary": "A thief who steals corporate secrets through the use of dream-sharing technology.",
  "genreId": 1
}
```

## Quick Manual Check

```bash
curl -s http://localhost:8080/api/movies | jq
curl -s http://localhost:8080/api/genres | jq
```
